---
output: pdf_document
---

\begin{quote}
\emph{Without an interpretable scale, it is difficult to use effect size to communicate results in a meaningful and useful way.}
--- Preacher and Hayes, 2011
\end{quote}

\doublespacing

# Introduction

The proposed integration of average marginal effects and mediation analysis is designed to resolve two major obstacles currently found in mediation analysis:

1. The difficulty of performing mediation analysis with categorical mediators and/or outcomes, and
2. The lack of reliable and flexible effect size estimates in mediation analysis---especially with categorical mediators and/or outcomes.

\noindent These issues are relatively common in prevention work [e.g., @Hoeppner2017] and the present approaches are not adequate---as was discussed at length in the previous chapters. In this chapter, the integration of Average Marginal Effects (AMEs) and mediation analysis---*Marginal Mediation Analysis* (MMA)---is discussed, including its interpretation and assumptions as well as its benefits and limitations. It is expected that this adjustment to both the modeling and the interpretation will help researchers in the health and prevention sciences to be able to model their data in the most properly-specified way and be able to communicate their findings clearly.

## Effect Sizes

> "First, virtually all effect size indices should be scaled appropriately, given the measurement and the question of interest. Without an *interpretable scale*, it is difficult to use effect size to communicate results in a meaningful and useful way.... Second, it should be emphasized that effect size estimates are themselves sample statistics and thus will almost certainly differ from their corresponding population values. Therefore, it is important to report confidence intervals for effect sizes..." [@Preacher2011, pg. 95, emphasis added].

In this chapter, it is shown that both of these aspects of proper effect size estimation and reporting are adequately represented when using Marginal Mediation. Of particular note, unlike many effect sizes that are only useful in certain research questions, the effect sizes produced by AMEs---and thus found in Marginal Mediation Analysis---are flexibly oriented to "be scaled appropriately" to best "communicate results in a meaningful and useful way" for a wide variety of situations. Regarding mediation analysis specifically, @Preacher2011 continue: "it is important to develop a way to gauge the effect size of the product term $ab$ itself," (pg. 95). That is, not only does the effect size of the individual paths need to be meaningful but the product of $a \times b$ must be as well. It can be added that a meaningful effect size of the total effect is also necessary (e.g., $a \times b + c'$) in a way that allows $a \times b$ and $c'$ to be comparable.

# Definition

The form of the general marginal mediation model, including the post-estimation step, are demonstrated in the following equations, where Equations \ref{equation_a} and \ref{equation_b} demonstrate the mediation estimation while Equations \ref{equation_AMEa} and \ref{equation_AMEb} show the post-estimation procedures. 
\begin{equation}\label{equation_a}
M_{ij} = a_0 + \sum_{k=1}^p a_k x_{ki} + \epsilon_i \text{ }\text{ }\text{ for j = 1, ..., m mediators}
\end{equation}
\begin{equation}\label{equation_b}
Y_{i} = \beta_0 + \sum_{j = 1}^m b_j M_{ij} + \sum_{k=1}^p c_k^{'} x_{ki} + \epsilon_i
\end{equation}
\noindent for the $ith$ individual, for $k = 1, ..., p$ predictors, and $j = 1, ..., m$ mediators. The paths are all labeled with their common term (i.e., path $a$ is labeled $a$). Combining these two equations provides the full mediation model. Using these models, we apply the post-estimation of the average marginal effects as presented by @Bartus2005. For a continuous $x$ variable, the average marginal effect of path $a$ is:
\begin{equation}\label{equation_AMEa}
AME^a_k = a_k \frac{1}{n} \sum_{i=1}^n f(a X)
\end{equation}
\noindent where $f$ refers to the derivative of the estimate with respect to $x_i$, $a x_i$ is the linear combination of the predictors, and $AME_k^a$ is the average marginal effect of the $a$ path for the $kth$ variable. Similarly, the AME of a dummy coded variable in the $a$ path is:
\begin{equation}\label{equation_AMEb}
AME_{k}^a = \frac{1}{n} \sum_{i=1}^{n} \big[ F(a X | x_{ki} = 1) - F(a X | x_{ki} = 0) \big]
\end{equation}
\noindent where $F(a X | x_{ki} = 1)$ is the predicted value of the $ith$ observation when the dummy variable equals one and $F(a X | x_{ki} = 0)$ is the predicted value when the dummy value equals zero. 

Notably, these same post-estimation equations can be used for the $b$ and $c'$ paths as well. 

# Interpretation

The interpretation of Marginal Mediation is based on the original units of the mediator(s) and outcome(s). Because there are so many possible combinations of GLM types within mediation analysis, instead of outlining every combination, the basic principles are presented that apply to all situations.

## Principle 1: The individual paths are interpreted based on the corresponding endogenous variable's original metric.
The individual paths have interpretations identical to those of AMEs, as discussed in Chapter 2. Therefore, the $a$ path depends on the type of mediator and modeling approach chosen. For example, for a binary mediator, the $a$ path is a probability (risk); a mediator representing a count has an $a$ path that is in the same count units.


## Principle 2: The indirect effect, as a combination of the $a$ and $b$ paths, are interpreted based on the outcome's original metric.
The indirect effect is joining two paths, possibly of different metrics. However, the interpretation is still straightforward: the entire effect will be in the outcome's original metric. An example may be beneficial to highlight this principle.

Suppose there are data with a hypothesized binary mediator (depression or no depression) and a continuous outcome (number of hospital visits). A logistic regression is used to model path $a$ and a linear regression is used for the $b$ and $c'$ paths. After calculating the AME of the paths, path $a$ is in units of risk (of depression) while path $b$ is the difference in the number of hospital visits between depressed and not depressed individuals. Combining these two metrics is shown in Figure \ref{fig:combining}.

Another way to understand how these combine in such a straightforward manner is to consider the marginal effects (i.e., the derivatives) of each part of the indirect effect in a simplified manner:
\begin{equation}\label{eq:der}
\frac{dM}{dX} * \frac{dY}{dM} = \frac{1}{k_1}\frac{dY}{dX}
\end{equation}
\begin{equation}\label{eq:der2}
\frac{\cancel{dM}}{dX} * \frac{dY}{\cancel{dM}} = \frac{1}{k_1}\frac{dY}{dX}
\end{equation}

\noindent That is, a change in M for a change in X multiplied by a change in Y for a change in M equals some of the change in Y for a change in X. The derivative is additive---a small change in $X$ results in a small change in $Y$ without depending on the value of the predictor itself. In GLMs, without using the AME, the derivatives do not seamlessly combine. The example below demonstrates if a GLM, sans AME, is used to assess the $a$ path.
\begin{equation}
\frac{dM}{dX} f(X) * \frac{dY}{dM} \neq \frac{1}{k_1}\frac{dY}{dX}
\end{equation}
\noindent but instead:
\begin{equation}
\frac{dM}{dX} f(X) * \frac{dY}{dM} = \frac{1}{k_1}\frac{dY}{dX} f(X)
\end{equation}
\noindent where $f(X)$ is an arbitrary function of $X$ (depending on the model), and $X$ is the only predictor. In this case, the small change in $X$ has a differential effect depending on the value of $X$ itself (e.g., Figure \ref{fig:combining}). This overall reasoning holds across GLM types (e.g., logistic, Poisson, negative binomial). 


\begin{figure}[tb]
  \includegraphics[width=\linewidth]{fig_combining.jpg}
  \caption{Given that path a is additive and in probability units, combining it with the difference in the number of visits for a change in probability is straightforward. Here, $a \times b$ essentially says: ``There is an increased probability of a of having depression for a one unit change in the predictor, which if the individual does have depression, that in turn increases the number of hospital visits by b." That is, the change in the number of visits for a one unit change in the predictor indirectly through the mediator.}
  \label{fig:combining}
\end{figure}


## Principle 3: Both the direct and total effects are interpreted based on the outcome's original metric.
Similar to Principle 2, the direct and total effects are in the outcome's original units. This is intuitive given that the AME of the direct effect is in the outcome's units, and it is not combined with any other path. For the total effect, the indirect and direct effect (which are both in the same units) are added together to get the complete effect. It is expected that, as in linear regression (but that is lacking in other situations), $a \times b + c'= c$. That is, the indirect and direct effects together will equal the total effect. This expectation was tested, as described in the next chapter.



# Assumptions

The assumptions inherent in Marginal Mediation are the same as those presented in Chapter 1 regarding mediation analysis. The only additional assumption regards the ability of the effect to be represented additively (i.e., can the effect be represented linearly after accounting for the marginal effect at each observed level of the covariates?). In linear models, this is already included as an implicit assumption. For other models, although the relationship is not entirely linear, taking the average of the effects across the covariates is assumed to be representative of the relationship.

# Reproducibility and Applicability

As mentioned previously, categorical mediators/outcomes are generally not difficult to model using GLMs---only the interpretation is difficult. Generalized linear models, in conjunction with AMEs, will allow researchers to use more correct functional forms, thereby reducing the justification used to fit poorly specified models that have an easier interpretation. 

With this framework, MMA can be applied across the GLM spectrum and essentially any combination of GLM types. For example, a marginal mediation model is defined when the mediator is binary and the outcome is continuous; when the mediator is a count and the outcome is ordinal; when the mediator is continuous and the outcome is binary. Each has a straightforward, yet informative, interpretation as outlined by the principles above. This attribute alone can increase the reproducibility of research using mediation analysis. 

Additionally, the interpretation across the paths and effects is straightforward and flexible. Other researchers, laypersons, lawmakers, and clinicians can assess the magnitude, the meaning, and the utility of findings much easier---thus, increasing the reach and impact of research. In mediation analysis, this can prove largely beneficial given the already complex nature of the modeling scheme. By simplifying the interpretation, less cognitive resources are required to gain a basic understanding of the findings; instead, more resources can be used to understand how to apply it and assess future research questions based on the findings.



\singlespacing